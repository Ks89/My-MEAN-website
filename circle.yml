## Customize the test machine
machine:

  # Version of ruby to use
  node:
    version:
      7.9.0

  # Add some environment variables
  environment:
    NODE_ENV: test
    CI: yes
    JWT_SECRET: faketestjwt
    TWITTER_CONSUMER_KEY: consumerkey
    TWITTER_CONSUMER_SECRET: consumersecret
    TWITTER_CALLBACK_URL: http://127.0.0.1:3300/api/auth/twitter/callback
    FACEBOOK_APP_ID: appid
    FACEBOOK_APP_SECRET: appsecret
    FACEBOOK_CALLBACK_URL: http://localhost:3300/api/auth/facebook/callback
    GOOGLE_CLIENT_ID: clientid
    GOOGLE_CLIENT_SECRET: clientsecret
    GOOGLE_CALLBACK_URL: http://localhost:3300/api/auth/google/callback
    GITHUB_CLIENT_ID: clientid
    GITHUB_CLIENT_SECRET: clientsecret
    GITHUB_CALLBACK_URL: http://localhost:3300/api/auth/github/callback
    LINKEDIN_CLIENT_ID: clientid
    LINKEDIN_CLIENT_SECRET: clientsecret
    LINKEDIN_CALLBACK_URL: http://localhost:3300/api/auth/linkedin/callback
    USER_EMAIL: fake@fake.it
    PASS_EMAIL: fakepasswordemail
    RECAPTCHA_PUBLIC: recaptchapublic
    RECAPTCHA_SECRET: recaptchasecret

  services:
#    - mongodb # not necessary because started automatically
    - redis

## Customize dependencies
dependencies:
  pre:
    - npm install pm2 -g

  override:
    - npm install --dev

## Customize test commands
test:
#  override:
#    - phpunit test/unit-tests # use PHPunit for testing
  post:
    - echo "npm docs on circle ci"
    - npm run docs
    - echo "npm test on circle ci"
    - npm test
    - npm run nyc:threshold
#    - npm run codeclimate
#    - npm run coveralls